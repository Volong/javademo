#### 003

一个类从加载到使用，一般会经历如下过程：

加载 -> 验证 -> 准备 -> 解析 -> 初始化 -> 使用 -> 卸载

加载：在代码中用到这个类时，“.class”字节码文件会加载这个类到JVM内存里面来。

验证：校验加载进来的“.class”文件是否符合JVM规范。

准备：给类分配内存空间，并对类变量分配内存空间，并赋默认值。

解析：把符号引用替换为直接引用。

初始化：执行类的初始化代码。这个时候才会真正的给变量赋我们编码的值。

初始化类的时机：

1. 通过关键词`new`实例化类时
2. 包含`main()`方法的主类

初始化一个类时，如果它的父类还没初始化，则必须先初始化他的父类。

类加载器：

1. **启动类加载器（Bootstrap ClassLoader）**

   加载Java安装目录下`lib`目录中的核心类库

2. **扩展类加载器（Extension ClassLoader）**

   加载Java安装目录下`lib/ext`目录中的类

3. **应用程序类加载器（Application ClassLoader）**

   加载`classpath`路径中的类。可以理解为加载我们写好的那些类

4. **自定义类加载器**

   自己定义，按照我们的需求去加载类

双亲委派模型：以上类加载器按照加载类的优先级从上到下一次降低。

类加载器在加载一个类时，会先委托给自己的父类加载器，最终会委托到顶层的类加载器，如果类加载器在自己负责加载的范围内没有找到这个类，才会让自己的子类加载器去加载。

如何对`.class`文件进行处理而不会被反编译？

在编译时，对字节码进行加密，在加载时使用自定义的类加载器来解密文件。